package databaseConnectivity;

import java.sql.Connection;
import java.sql.DatabaseMetaData;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class CRUD_Operation {

	public static void main(String[] args) throws Exception {
		Class.forName("com.mysql.cj.jdbc.Driver");
		String dbname="new_db";
		String url="jdbc:mysql://localhost:3306/";
		String username="root";
		String password="7324Idea#";
		Connection con = DriverManager.getConnection(url,username,password);
		Statement stmt = con.createStatement();
        String showDatabasesQuery = "SHOW DATABASES";
        ResultSet resultSet1 = stmt.executeQuery(showDatabasesQuery);
        System.out.println("Databases:");
        while (resultSet1.next()) {
            String databaseName = resultSet1.getString(1);
            System.out.println(databaseName);
        }
		String createDatabaseQuery = "CREATE DATABASE " + dbname;

		stmt.executeUpdate(createDatabaseQuery);
		DatabaseMetaData metaData = con.getMetaData();
        ResultSet resultSet2 = metaData.getTables(null, null, "%", new String[]{"TABLE"});
        System.out.println("Tables in the database:");
        while (resultSet2.next()) {
            String tableName = resultSet2.getString("TABLE_NAME");
            System.out.println(tableName);
        }
//		String query="select * from "

	}

}
